import{lazy as Tt,createComponent as We,getOwner as ye,runWithOwner as qe,createMemo as k,createContext as Ke,useContext as He,createSignal as F,createRenderEffect as Vt,untrack as Pe,on as Dt,startTransition as N,resetErrorBoundaries as Ie,getListener as Mt,onCleanup as Xe,sharedConfig as S,$TRACK as Nt}from"solid-js";import{ssrElement as re,escape as Lt,mergeProps as Ut,ssr as _t,isServer as b,getRequestEvent as O,renderToString as Bt}from"solid-js/web";import{provideRequestEvent as Ge}from"solid-js/web/storage";import{l as Wt,a as qt,g as Kt,b as Ht,s as Xt,c as Gt,m as ke,d as Fe,e as se,f as Jt}from"./rpc.mjs";import{eventHandler as Zt}from"h3";var Qt=(t=>(t[t.AggregateError=1]="AggregateError",t[t.ArrowFunction=2]="ArrowFunction",t[t.ErrorPrototypeStack=4]="ErrorPrototypeStack",t[t.ObjectAssign=8]="ObjectAssign",t[t.BigIntTypedArray=16]="BigIntTypedArray",t))(Qt||{});function A(t,e){if(!t)throw e}function Yt(t){switch(t){case'"':return'\\"';case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"\f":return"\\f";case"<":return"\\x3C";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return}}function w(t){let e="",r=0,s;for(let i=0,n=t.length;i<n;i++)s=Yt(t[i]),s&&(e+=t.slice(r,i)+s,r=i+1);return r===0?e=t:e+=t.slice(r),e}function er(t){switch(t){case"\\\\":return"\\";case'\\"':return'"';case"\\n":return`
`;case"\\r":return"\r";case"\\b":return"\b";case"\\t":return"	";case"\\f":return"\f";case"\\x3C":return"<";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029";default:return t}}function I(t){return t.replace(/(\\\\|\\"|\\n|\\r|\\b|\\t|\\f|\\u2028|\\u2029|\\x3C)/g,er)}var D="__SEROVAL_REFS__",X="$R",H=`self.${X}`;function tr(t){return t==null?`${H}=${H}||[]`:`(${H}=${H}||{})["${w(t)}"]=[]`}var Je=new Map,C=new Map;function de(t){return Je.has(t)}function rr(t){return C.has(t)}function sr(t){return A(de(t),new Br(t)),Je.get(t)}function ir(t){return A(rr(t),new Wr(t)),C.get(t)}typeof globalThis<"u"?Object.defineProperty(globalThis,D,{value:C,configurable:!0,writable:!1,enumerable:!1}):typeof window<"u"?Object.defineProperty(window,D,{value:C,configurable:!0,writable:!1,enumerable:!1}):typeof self<"u"?Object.defineProperty(self,D,{value:C,configurable:!0,writable:!1,enumerable:!1}):typeof global<"u"&&Object.defineProperty(global,D,{value:C,configurable:!0,writable:!1,enumerable:!1});function Ze(t,e){for(let r=0,s=e.length;r<s;r++){let i=e[r];t.has(i)||(t.add(i),i.extends&&Ze(t,i.extends))}}function Qe(t){if(t){let e=new Set;return Ze(e,t),[...e]}}var nr={0:"Symbol.asyncIterator",1:"Symbol.hasInstance",2:"Symbol.isConcatSpreadable",3:"Symbol.iterator",4:"Symbol.match",5:"Symbol.matchAll",6:"Symbol.replace",7:"Symbol.search",8:"Symbol.species",9:"Symbol.split",10:"Symbol.toPrimitive",11:"Symbol.toStringTag",12:"Symbol.unscopables"},Ye={[Symbol.asyncIterator]:0,[Symbol.hasInstance]:1,[Symbol.isConcatSpreadable]:2,[Symbol.iterator]:3,[Symbol.match]:4,[Symbol.matchAll]:5,[Symbol.replace]:6,[Symbol.search]:7,[Symbol.species]:8,[Symbol.split]:9,[Symbol.toPrimitive]:10,[Symbol.toStringTag]:11,[Symbol.unscopables]:12},ar={0:Symbol.asyncIterator,1:Symbol.hasInstance,2:Symbol.isConcatSpreadable,3:Symbol.iterator,4:Symbol.match,5:Symbol.matchAll,6:Symbol.replace,7:Symbol.search,8:Symbol.species,9:Symbol.split,10:Symbol.toPrimitive,11:Symbol.toStringTag,12:Symbol.unscopables},or={2:"!0",3:"!1",1:"void 0",0:"null",4:"-0",5:"1/0",6:"-1/0",7:"0/0"},lr={2:!0,3:!1,1:void 0,0:null,4:-0,5:1/0,6:-1/0,7:NaN},et={0:"Error",1:"EvalError",2:"RangeError",3:"ReferenceError",4:"SyntaxError",5:"TypeError",6:"URIError"},cr={0:Error,1:EvalError,2:RangeError,3:ReferenceError,4:SyntaxError,5:TypeError,6:URIError};function x(t){return{t:2,i:void 0,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}var he=x(2),fe=x(3),ur=x(1),dr=x(0),hr=x(4),fr=x(5),pr=x(6),vr=x(7);function be(t){return t instanceof EvalError?1:t instanceof RangeError?2:t instanceof ReferenceError?3:t instanceof SyntaxError?4:t instanceof TypeError?5:t instanceof URIError?6:0}function gr(t){let e=et[be(t)];return t.name!==e?{name:t.name}:t.constructor.name!==e?{name:t.constructor.name}:{}}function Oe(t,e){let r=gr(t),s=Object.getOwnPropertyNames(t);for(let i=0,n=s.length,a;i<n;i++)a=s[i],a!=="name"&&a!=="message"&&(a==="stack"?e&4&&(r=r||{},r[a]=t[a]):(r=r||{},r[a]=t[a]));return r}function tt(t){return Object.isFrozen(t)?3:Object.isSealed(t)?2:Object.isExtensible(t)?0:1}function mr(t){switch(t){case 1/0:return fr;case-1/0:return pr}return t!==t?vr:Object.is(t,-0)?hr:{t:0,i:void 0,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function pe(t){return{t:1,i:void 0,s:w(t),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function yr(t){return{t:3,i:void 0,s:""+t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function br(t){return{t:4,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function wr(t,e){return{t:5,i:t,s:e.toISOString(),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,f:void 0,a:void 0,b:void 0,o:void 0}}function zr(t,e){return{t:6,i:t,s:void 0,l:void 0,c:w(e.source),m:e.flags,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Sr(t,e){let r=new Uint8Array(e),s=r.length,i=new Array(s);for(let n=0;n<s;n++)i[n]=r[n];return{t:19,i:t,s:i,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Rr(t,e){return{t:17,i:t,s:Ye[e],l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function $e(t,e){return{t:18,i:t,s:w(sr(e)),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function rt(t,e,r){return{t:25,i:t,s:r,l:void 0,c:w(e),m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Ar(t,e,r){return{t:9,i:t,s:void 0,l:e.length,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:tt(e)}}function xr(t,e){return{t:21,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function Er(t,e,r){return{t:15,i:t,s:void 0,l:e.length,c:e.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function Pr(t,e,r){return{t:16,i:t,s:void 0,l:e.length,c:e.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function Ir(t,e,r){return{t:20,i:t,s:void 0,l:e.byteLength,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function kr(t,e,r){return{t:13,i:t,s:be(e),l:void 0,c:void 0,m:w(e.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Fr(t,e,r){return{t:14,i:t,s:be(e),l:void 0,c:void 0,m:w(e.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Or(t,e,r){return{t:7,i:t,s:void 0,l:e,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:void 0}}function st(t,e){return{t:28,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[t,e],f:void 0,b:void 0,o:void 0}}function it(t,e){return{t:30,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[t,e],f:void 0,b:void 0,o:void 0}}function nt(t,e,r){return{t:31,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:e,b:void 0,o:void 0}}function $r(t,e){return{t:32,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function Cr(t,e){return{t:33,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function jr(t,e){return{t:34,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function at(t){let e=[],r=-1,s=-1,i=t[Symbol.iterator]();for(;;)try{let n=i.next();if(e.push(n.value),n.done){s=e.length-1;break}}catch(n){r=e.length,e.push(n)}return{v:e,t:r,d:s}}function Tr(t){return()=>{let e=0;return{[Symbol.iterator](){return this},next(){if(e>t.d)return{done:!0,value:void 0};let r=e++,s=t.v[r];if(r===t.t)throw s;return{done:r===t.d,value:s}}}}}var Vr={},Dr={},Mr={0:{},1:{},2:{},3:{},4:{}},{toString:we}=Object.prototype;function Nr(t,e){return e instanceof Error?`Seroval caught an error during the ${t} process.
  
${e.name}
${e.message}

- For more information, please check the "cause" property of this error.
- If you believe this is an error in Seroval, please submit an issue at https://github.com/lxsmnsyc/seroval/issues/new`:`Seroval caught an error during the ${t} process.

"${we.call(e)}"

For more information, please check the "cause" property of this error.`}var ze=class extends Error{constructor(e,r){super(Nr(e,r)),this.cause=r}},Lr=class extends ze{constructor(t){super("parsing",t)}},Ur=class extends ze{constructor(t){super("serialization",t)}},_r=class extends ze{constructor(t){super("deserialization",t)}},J=class extends Error{constructor(e){super(`The value ${we.call(e)} of type "${typeof e}" cannot be parsed/serialized.
      
There are few workarounds for this problem:
- Transform the value in a way that it can be serialized.
- If the reference is present on multiple runtimes (isomorphic), you can use the Reference API to map the references.`),this.value=e}},ot=class extends Error{constructor(e){super('Unsupported node type "'+e.t+'".')}},lt=class extends Error{constructor(e){super('Missing plugin for tag "'+e+'".')}},V=class extends Error{constructor(e){super('Missing "'+e+'" instance.')}},Br=class extends Error{constructor(e){super('Missing reference for the value "'+we.call(e)+'" of type "'+typeof e+'"'),this.value=e}},Wr=class extends Error{constructor(t){super('Missing reference for id "'+w(t)+'"')}},qr=class extends Error{constructor(t){super('Unknown TypedArray "'+t+'"')}},Kr=class{constructor(e){this.marked=new Set,this.plugins=e.plugins,this.features=31^(e.disabledFeatures||0),this.refs=e.refs||new Map}markRef(e){this.marked.add(e)}isMarked(e){return this.marked.has(e)}getIndexedValue(e){let r=this.refs.get(e);if(r!=null)return this.markRef(r),{type:1,value:br(r)};let s=this.refs.size;return this.refs.set(e,s),{type:0,value:s}}getReference(e){let r=this.getIndexedValue(e);return r.type===1?r:de(e)?{type:2,value:$e(r.value,e)}:r}getStrictReference(e){A(de(e),new J(e));let r=this.getIndexedValue(e);return r.type===1?r.value:$e(r.value,e)}parseFunction(e){return this.getStrictReference(e)}parseWellKnownSymbol(e){let r=this.getReference(e);return r.type!==0?r.value:(A(e in Ye,new J(e)),Rr(r.value,e))}parseSpecialReference(e){let r=this.getIndexedValue(Mr[e]);return r.type===1?r.value:{t:26,i:r.value,s:e,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}parseIteratorFactory(){let e=this.getIndexedValue(Vr);return e.type===1?e.value:{t:27,i:e.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseWellKnownSymbol(Symbol.iterator),b:void 0,o:void 0}}parseAsyncIteratorFactory(){let e=this.getIndexedValue(Dr);return e.type===1?e.value:{t:29,i:e.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(1),this.parseWellKnownSymbol(Symbol.asyncIterator)],f:void 0,b:void 0,o:void 0}}createObjectNode(e,r,s,i){return{t:s?11:10,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:i,e:void 0,a:void 0,f:void 0,b:void 0,o:tt(r)}}createMapNode(e,r,s,i){return{t:8,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:{k:r,v:s,s:i},a:void 0,f:this.parseSpecialReference(0),b:void 0,o:void 0}}createPromiseConstructorNode(e){return{t:22,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseSpecialReference(1),b:void 0,o:void 0}}};function ve(){let t,e;return{promise:new Promise((r,s)=>{t=r,e=s}),resolve(r){t(r)},reject(r){e(r)}}}function Hr(t){return"__SEROVAL_STREAM__"in t}function W(){let t=new Set,e=[],r=!0,s=!1;function i(o){for(let l of t.keys())l.next(o)}function n(o){for(let l of t.keys())l.throw(o)}function a(o){for(let l of t.keys())l.return(o)}return{__SEROVAL_STREAM__:!0,on(o){r&&t.add(o);for(let l=0,c=e.length;l<c;l++){let d=e[l];l===c-1?s?o.return(d):o.throw(d):o.next(d)}return()=>{r&&t.delete(o)}},next(o){r&&(e.push(o),i(o))},throw(o){r&&(e.push(o),n(o),r=!1,s=!1,t.clear())},return(o){r&&(e.push(o),a(o),r=!1,s=!0,t.clear())}}}function Xr(t){let e=W(),r=t[Symbol.asyncIterator]();async function s(){try{let i=await r.next();i.done?e.return(i.value):(e.next(i.value),await s())}catch(i){e.throw(i)}}return s().catch(()=>{}),e}function Gr(t){return()=>{let e=[],r=[],s=0,i=-1,n=!1;function a(){for(let l=0,c=r.length;l<c;l++)r[l].resolve({done:!0,value:void 0})}t.on({next(l){let c=r.shift();c&&c.resolve({done:!1,value:l}),e.push(l)},throw(l){let c=r.shift();c&&c.reject(l),a(),i=e.length,e.push(l),n=!0},return(l){let c=r.shift();c&&c.resolve({done:!0,value:l}),a(),i=e.length,e.push(l)}});function o(){let l=s++,c=e[l];if(l!==i)return{done:!1,value:c};if(n)throw c;return{done:!0,value:c}}return{[Symbol.asyncIterator](){return this},async next(){if(i===-1){let l=s++;if(l>=e.length){let c=ve();return r.push(c),await c.promise}return{done:!1,value:e[l]}}return s>i?{done:!0,value:void 0}:o()}}}}function Jr(t){switch(t){case"Int8Array":return Int8Array;case"Int16Array":return Int16Array;case"Int32Array":return Int32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":return Uint16Array;case"Uint32Array":return Uint32Array;case"Uint8ClampedArray":return Uint8ClampedArray;case"Float32Array":return Float32Array;case"Float64Array":return Float64Array;case"BigInt64Array":return BigInt64Array;case"BigUint64Array":return BigUint64Array;default:throw new qr(t)}}function Ce(t,e){switch(e){case 3:return Object.freeze(t);case 1:return Object.preventExtensions(t);case 2:return Object.seal(t);default:return t}}var Zr=class{constructor(e){this.plugins=e.plugins,this.refs=e.refs||new Map}deserializeReference(e){return this.assignIndexedValue(e.i,ir(I(e.s)))}deserializeArray(e){let r=e.l,s=this.assignIndexedValue(e.i,new Array(r)),i;for(let n=0;n<r;n++)i=e.a[n],i&&(s[n]=this.deserialize(i));return Ce(s,e.o),s}deserializeProperties(e,r){let s=e.s;if(s){let i=e.k,n=e.v;for(let a=0,o;a<s;a++)o=i[a],typeof o=="string"?r[I(o)]=this.deserialize(n[a]):r[this.deserialize(o)]=this.deserialize(n[a])}return r}deserializeObject(e){let r=this.assignIndexedValue(e.i,e.t===10?{}:Object.create(null));return this.deserializeProperties(e.p,r),Ce(r,e.o),r}deserializeDate(e){return this.assignIndexedValue(e.i,new Date(e.s))}deserializeRegExp(e){return this.assignIndexedValue(e.i,new RegExp(I(e.c),e.m))}deserializeSet(e){let r=this.assignIndexedValue(e.i,new Set),s=e.a;for(let i=0,n=e.l;i<n;i++)r.add(this.deserialize(s[i]));return r}deserializeMap(e){let r=this.assignIndexedValue(e.i,new Map),s=e.e.k,i=e.e.v;for(let n=0,a=e.e.s;n<a;n++)r.set(this.deserialize(s[n]),this.deserialize(i[n]));return r}deserializeArrayBuffer(e){let r=new Uint8Array(e.s);return this.assignIndexedValue(e.i,r.buffer)}deserializeTypedArray(e){let r=Jr(e.c),s=this.deserialize(e.f);return this.assignIndexedValue(e.i,new r(s,e.b,e.l))}deserializeDataView(e){let r=this.deserialize(e.f);return this.assignIndexedValue(e.i,new DataView(r,e.b,e.l))}deserializeDictionary(e,r){if(e.p){let s=this.deserializeProperties(e.p,{});Object.assign(r,s)}return r}deserializeAggregateError(e){let r=this.assignIndexedValue(e.i,new AggregateError([],I(e.m)));return this.deserializeDictionary(e,r)}deserializeError(e){let r=cr[e.s],s=this.assignIndexedValue(e.i,new r(I(e.m)));return this.deserializeDictionary(e,s)}deserializePromise(e){let r=ve(),s=this.assignIndexedValue(e.i,r),i=this.deserialize(e.f);return e.s?r.resolve(i):r.reject(i),s.promise}deserializeBoxed(e){return this.assignIndexedValue(e.i,Object(this.deserialize(e.f)))}deserializePlugin(e){let r=this.plugins;if(r){let s=I(e.c);for(let i=0,n=r.length;i<n;i++){let a=r[i];if(a.tag===s)return this.assignIndexedValue(e.i,a.deserialize(e.s,this,{id:e.i}))}}throw new lt(e.c)}deserializePromiseConstructor(e){return this.assignIndexedValue(e.i,ve()).promise}deserializePromiseResolve(e){let r=this.refs.get(e.i);A(r,new V("Promise")),r.resolve(this.deserialize(e.a[1]))}deserializePromiseReject(e){let r=this.refs.get(e.i);A(r,new V("Promise")),r.reject(this.deserialize(e.a[1]))}deserializeIteratorFactoryInstance(e){this.deserialize(e.a[0]);let r=this.deserialize(e.a[1]);return Tr(r)}deserializeAsyncIteratorFactoryInstance(e){this.deserialize(e.a[0]);let r=this.deserialize(e.a[1]);return Gr(r)}deserializeStreamConstructor(e){let r=this.assignIndexedValue(e.i,W()),s=e.a.length;if(s)for(let i=0;i<s;i++)this.deserialize(e.a[i]);return r}deserializeStreamNext(e){let r=this.refs.get(e.i);A(r,new V("Stream")),r.next(this.deserialize(e.f))}deserializeStreamThrow(e){let r=this.refs.get(e.i);A(r,new V("Stream")),r.throw(this.deserialize(e.f))}deserializeStreamReturn(e){let r=this.refs.get(e.i);A(r,new V("Stream")),r.return(this.deserialize(e.f))}deserializeIteratorFactory(e){this.deserialize(e.f)}deserializeAsyncIteratorFactory(e){this.deserialize(e.a[1])}deserialize(e){try{switch(e.t){case 2:return lr[e.s];case 0:return e.s;case 1:return I(e.s);case 3:return BigInt(e.s);case 4:return this.refs.get(e.i);case 18:return this.deserializeReference(e);case 9:return this.deserializeArray(e);case 10:case 11:return this.deserializeObject(e);case 5:return this.deserializeDate(e);case 6:return this.deserializeRegExp(e);case 7:return this.deserializeSet(e);case 8:return this.deserializeMap(e);case 19:return this.deserializeArrayBuffer(e);case 16:case 15:return this.deserializeTypedArray(e);case 20:return this.deserializeDataView(e);case 14:return this.deserializeAggregateError(e);case 13:return this.deserializeError(e);case 12:return this.deserializePromise(e);case 17:return ar[e.s];case 21:return this.deserializeBoxed(e);case 25:return this.deserializePlugin(e);case 22:return this.deserializePromiseConstructor(e);case 23:return this.deserializePromiseResolve(e);case 24:return this.deserializePromiseReject(e);case 28:return this.deserializeIteratorFactoryInstance(e);case 30:return this.deserializeAsyncIteratorFactoryInstance(e);case 31:return this.deserializeStreamConstructor(e);case 32:return this.deserializeStreamNext(e);case 33:return this.deserializeStreamThrow(e);case 34:return this.deserializeStreamReturn(e);case 27:return this.deserializeIteratorFactory(e);case 29:return this.deserializeAsyncIteratorFactory(e);default:throw new ot(e)}}catch(r){throw new _r(r)}}},Qr=class extends Zr{constructor(e){super(e),this.mode="vanilla",this.marked=new Set(e.markedRefs)}assignIndexedValue(e,r){return this.marked.has(e)&&this.refs.set(e,r),r}},Yr=/^[$A-Z_][0-9A-Z_$]*$/i;function je(t){let e=t[0];return(e==="$"||e==="_"||e>="A"&&e<="Z"||e>="a"&&e<="z")&&Yr.test(t)}function M(t){switch(t.t){case 0:return t.s+"="+t.v;case 2:return t.s+".set("+t.k+","+t.v+")";case 1:return t.s+".add("+t.v+")";case 3:return t.s+".delete("+t.k+")"}}function es(t){let e=[],r=t[0];for(let s=1,i=t.length,n,a=r;s<i;s++)n=t[s],n.t===0&&n.v===a.v?r={t:0,s:n.s,k:void 0,v:M(r)}:n.t===2&&n.s===a.s?r={t:2,s:M(r),k:n.k,v:n.v}:n.t===1&&n.s===a.s?r={t:1,s:M(r),k:void 0,v:n.v}:n.t===3&&n.s===a.s?r={t:3,s:M(r),k:n.k,v:void 0}:(e.push(r),r=n),a=n;return e.push(r),e}function Te(t){if(t.length){let e="",r=es(t);for(let s=0,i=r.length;s<i;s++)e+=M(r[s])+",";return e}}var ts="Object.create(null)",rs="new Set",ss="new Map",is="Promise.resolve",ns="Promise.reject",as={3:"Object.freeze",2:"Object.seal",1:"Object.preventExtensions",0:void 0},os=class{constructor(t){this.stack=[],this.flags=[],this.assignments=[],this.plugins=t.plugins,this.features=t.features,this.marked=new Set(t.markedRefs)}createFunction(t,e){return this.features&2?(t.length===1?t[0]:"("+t.join(",")+")")+"=>"+e:"function("+t.join(",")+"){return "+e+"}"}createEffectfulFunction(t,e){return this.features&2?(t.length===1?t[0]:"("+t.join(",")+")")+"=>{"+e+"}":"function("+t.join(",")+"){"+e+"}"}markRef(t){this.marked.add(t)}isMarked(t){return this.marked.has(t)}pushObjectFlag(t,e){t!==0&&(this.markRef(e),this.flags.push({type:t,value:this.getRefParam(e)}))}resolveFlags(){let t="";for(let e=0,r=this.flags,s=r.length;e<s;e++){let i=r[e];t+=as[i.type]+"("+i.value+"),"}return t}resolvePatches(){let t=Te(this.assignments),e=this.resolveFlags();return t?e?t+e:t:e}createAssignment(t,e){this.assignments.push({t:0,s:t,k:void 0,v:e})}createAddAssignment(t,e){this.assignments.push({t:1,s:this.getRefParam(t),k:void 0,v:e})}createSetAssignment(t,e,r){this.assignments.push({t:2,s:this.getRefParam(t),k:e,v:r})}createDeleteAssignment(t,e){this.assignments.push({t:3,s:this.getRefParam(t),k:e,v:void 0})}createArrayAssign(t,e,r){this.createAssignment(this.getRefParam(t)+"["+e+"]",r)}createObjectAssign(t,e,r){this.createAssignment(this.getRefParam(t)+"."+e,r)}isIndexedValueInStack(t){return t.t===4&&this.stack.includes(t.i)}serializeReference(t){return this.assignIndexedValue(t.i,D+'.get("'+t.s+'")')}serializeArrayItem(t,e,r){return e?this.isIndexedValueInStack(e)?(this.markRef(t),this.createArrayAssign(t,r,this.getRefParam(e.i)),""):this.serialize(e):""}serializeArray(t){let e=t.i;if(t.l){this.stack.push(e);let r=t.a,s=this.serializeArrayItem(e,r[0],0),i=s==="";for(let n=1,a=t.l,o;n<a;n++)o=this.serializeArrayItem(e,r[n],n),s+=","+o,i=o==="";return this.stack.pop(),this.pushObjectFlag(t.o,t.i),this.assignIndexedValue(e,"["+s+(i?",]":"]"))}return this.assignIndexedValue(e,"[]")}serializeProperty(t,e,r){if(typeof e=="string"){let s=Number(e),i=s>=0&&s.toString()===e||je(e);if(this.isIndexedValueInStack(r)){let n=this.getRefParam(r.i);return this.markRef(t.i),i&&s!==s?this.createObjectAssign(t.i,e,n):this.createArrayAssign(t.i,i?e:'"'+e+'"',n),""}return(i?e:'"'+e+'"')+":"+this.serialize(r)}return"["+this.serialize(e)+"]:"+this.serialize(r)}serializeProperties(t,e){let r=e.s;if(r){let s=e.k,i=e.v;this.stack.push(t.i);let n=this.serializeProperty(t,s[0],i[0]);for(let a=1,o=n;a<r;a++)o=this.serializeProperty(t,s[a],i[a]),n+=(o&&n&&",")+o;return this.stack.pop(),"{"+n+"}"}return"{}"}serializeObject(t){return this.pushObjectFlag(t.o,t.i),this.assignIndexedValue(t.i,this.serializeProperties(t,t.p))}serializeWithObjectAssign(t,e,r){let s=this.serializeProperties(t,e);return s!=="{}"?"Object.assign("+r+","+s+")":r}serializeStringKeyAssignment(t,e,r,s){let i=this.serialize(s),n=Number(r),a=n>=0&&n.toString()===r||je(r);if(this.isIndexedValueInStack(s))a&&n!==n?this.createObjectAssign(t.i,r,i):this.createArrayAssign(t.i,a?r:'"'+r+'"',i);else{let o=this.assignments;this.assignments=e,a&&n!==n?this.createObjectAssign(t.i,r,i):this.createArrayAssign(t.i,a?r:'"'+r+'"',i),this.assignments=o}}serializeAssignment(t,e,r,s){if(typeof r=="string")this.serializeStringKeyAssignment(t,e,r,s);else{let i=this.stack;this.stack=[];let n=this.serialize(s);this.stack=i;let a=this.assignments;this.assignments=e,this.createArrayAssign(t.i,this.serialize(r),n),this.assignments=a}}serializeAssignments(t,e){let r=e.s;if(r){let s=[],i=e.k,n=e.v;this.stack.push(t.i);for(let a=0;a<r;a++)this.serializeAssignment(t,s,i[a],n[a]);return this.stack.pop(),Te(s)}}serializeDictionary(t,e){if(t.p)if(this.features&8)e=this.serializeWithObjectAssign(t,t.p,e);else{this.markRef(t.i);let r=this.serializeAssignments(t,t.p);if(r)return"("+this.assignIndexedValue(t.i,e)+","+r+this.getRefParam(t.i)+")"}return this.assignIndexedValue(t.i,e)}serializeNullConstructor(t){return this.pushObjectFlag(t.o,t.i),this.serializeDictionary(t,ts)}serializeDate(t){return this.assignIndexedValue(t.i,'new Date("'+t.s+'")')}serializeRegExp(t){return this.assignIndexedValue(t.i,"/"+t.c+"/"+t.m)}serializeSetItem(t,e){return this.isIndexedValueInStack(e)?(this.markRef(t),this.createAddAssignment(t,this.getRefParam(e.i)),""):this.serialize(e)}serializeSet(t){let e=rs,r=t.l,s=t.i;if(r){let i=t.a;this.stack.push(s);let n=this.serializeSetItem(s,i[0]);for(let a=1,o=n;a<r;a++)o=this.serializeSetItem(s,i[a]),n+=(o&&n&&",")+o;this.stack.pop(),n&&(e+="(["+n+"])")}return this.assignIndexedValue(s,e)}serializeMapEntry(t,e,r,s){if(this.isIndexedValueInStack(e)){let i=this.getRefParam(e.i);if(this.markRef(t),this.isIndexedValueInStack(r)){let a=this.getRefParam(r.i);return this.createSetAssignment(t,i,a),""}if(r.t!==4&&r.i!=null&&this.isMarked(r.i)){let a="("+this.serialize(r)+",["+s+","+s+"])";return this.createSetAssignment(t,i,this.getRefParam(r.i)),this.createDeleteAssignment(t,s),a}let n=this.stack;return this.stack=[],this.createSetAssignment(t,i,this.serialize(r)),this.stack=n,""}if(this.isIndexedValueInStack(r)){let i=this.getRefParam(r.i);if(this.markRef(t),e.t!==4&&e.i!=null&&this.isMarked(e.i)){let a="("+this.serialize(e)+",["+s+","+s+"])";return this.createSetAssignment(t,this.getRefParam(e.i),i),this.createDeleteAssignment(t,s),a}let n=this.stack;return this.stack=[],this.createSetAssignment(t,this.serialize(e),i),this.stack=n,""}return"["+this.serialize(e)+","+this.serialize(r)+"]"}serializeMap(t){let e=ss,r=t.e.s,s=t.i,i=t.f,n=this.getRefParam(i.i);if(r){let a=t.e.k,o=t.e.v;this.stack.push(s);let l=this.serializeMapEntry(s,a[0],o[0],n);for(let c=1,d=l;c<r;c++)d=this.serializeMapEntry(s,a[c],o[c],n),l+=(d&&l&&",")+d;this.stack.pop(),l&&(e+="(["+l+"])")}return i.t===26&&(this.markRef(i.i),e="("+this.serialize(i)+","+e+")"),this.assignIndexedValue(s,e)}serializeArrayBuffer(t){let e="new Uint8Array(",r=t.s,s=r.length;if(s){e+="["+r[0];for(let i=1;i<s;i++)e+=","+r[i];e+="]"}return this.assignIndexedValue(t.i,e+").buffer")}serializeTypedArray(t){return this.assignIndexedValue(t.i,"new "+t.c+"("+this.serialize(t.f)+","+t.b+","+t.l+")")}serializeDataView(t){return this.assignIndexedValue(t.i,"new DataView("+this.serialize(t.f)+","+t.b+","+t.l+")")}serializeAggregateError(t){let e=t.i;this.stack.push(e);let r=this.serializeDictionary(t,'new AggregateError([],"'+t.m+'")');return this.stack.pop(),r}serializeError(t){return this.serializeDictionary(t,"new "+et[t.s]+'("'+t.m+'")')}serializePromise(t){let e,r=t.f,s=t.i,i=t.s?is:ns;if(this.isIndexedValueInStack(r)){let n=this.getRefParam(r.i);e=i+(t.s?"().then("+this.createFunction([],n)+")":"().catch("+this.createEffectfulFunction([],"throw "+n)+")")}else{this.stack.push(s);let n=this.serialize(r);this.stack.pop(),e=i+"("+n+")"}return this.assignIndexedValue(s,e)}serializeWellKnownSymbol(t){return this.assignIndexedValue(t.i,nr[t.s])}serializeBoxed(t){return this.assignIndexedValue(t.i,"Object("+this.serialize(t.f)+")")}serializePlugin(t){let e=this.plugins;if(e)for(let r=0,s=e.length;r<s;r++){let i=e[r];if(i.tag===t.c)return this.assignIndexedValue(t.i,i.serialize(t.s,this,{id:t.i}))}throw new lt(t.c)}getConstructor(t){let e=this.serialize(t);return e===this.getRefParam(t.i)?e:"("+e+")"}serializePromiseConstructor(t){return this.assignIndexedValue(t.i,this.getConstructor(t.f)+"()")}serializePromiseResolve(t){return this.getConstructor(t.a[0])+"("+this.getRefParam(t.i)+","+this.serialize(t.a[1])+")"}serializePromiseReject(t){return this.getConstructor(t.a[0])+"("+this.getRefParam(t.i)+","+this.serialize(t.a[1])+")"}serializeSpecialReferenceValue(t){switch(t){case 0:return"[]";case 1:return this.createFunction(["s","f","p"],"((p=new Promise("+this.createEffectfulFunction(["a","b"],"s=a,f=b")+")).s=s,p.f=f,p)");case 2:return this.createEffectfulFunction(["p","d"],'p.s(d),p.status="success",p.value=d;delete p.s;delete p.f');case 3:return this.createEffectfulFunction(["p","d"],'p.f(d),p.status="failure",p.value=d;delete p.s;delete p.f');case 4:return this.createFunction(["b","a","s","l","p","f","e","n"],"(b=[],a=!0,s=!1,l=[],p=0,f="+this.createEffectfulFunction(["v","m","x"],"for(x=0;x<p;x++)l[x]&&l[x][m](v)")+",n="+this.createEffectfulFunction(["o","x","z","c"],'for(x=0,z=b.length;x<z;x++)(c=b[x],x===z-1?o[s?"return":"throw"](c):o.next(c))')+",e="+this.createFunction(["o","t"],"(a&&(l[t=p++]=o),n(o),"+this.createEffectfulFunction([],"a&&(l[t]=void 0)")+")")+",{__SEROVAL_STREAM__:!0,on:"+this.createFunction(["o"],"e(o)")+",next:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"next"))')+",throw:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"throw"),a=s=!1,l.length=0)')+",return:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"return"),a=!1,s=!0,l.length=0)')+"})");default:return""}}serializeSpecialReference(t){return this.assignIndexedValue(t.i,this.serializeSpecialReferenceValue(t.s))}serializeIteratorFactory(t){let e="",r=!1;return t.f.t!==4&&(this.markRef(t.f.i),e="("+this.serialize(t.f)+",",r=!0),e+=this.assignIndexedValue(t.i,this.createFunction(["s"],this.createFunction(["i","c","d","t"],"(i=0,t={["+this.getRefParam(t.f.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction([],"if(i>s.d)return{done:!0,value:void 0};if(d=s.v[c=i++],c===s.t)throw d;return{done:c===s.d,value:d}")+"})"))),r&&(e+=")"),e}serializeIteratorFactoryInstance(t){return this.getConstructor(t.a[0])+"("+this.serialize(t.a[1])+")"}serializeAsyncIteratorFactory(t){let e=t.a[0],r=t.a[1],s="";e.t!==4&&(this.markRef(e.i),s+="("+this.serialize(e)),r.t!==4&&(this.markRef(r.i),s+=(s?",":"(")+this.serialize(r)),s&&(s+=",");let i=this.assignIndexedValue(t.i,this.createFunction(["s"],this.createFunction(["b","c","p","d","e","t","f"],"(b=[],c=0,p=[],d=-1,e=!1,f="+this.createEffectfulFunction(["i","l"],"for(i=0,l=p.length;i<l;i++)p[i].s({done:!0,value:void 0})")+",s.on({next:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!1,value:v});b.push(v)")+",throw:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.f(v);f(),d=b.length,e=!0,b.push(v)")+",return:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!0,value:v});f(),d=b.length,b.push(v)")+"}),t={["+this.getRefParam(r.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction(["i","t","v"],"if(d===-1){return((i=c++)>=b.length)?(p.push(t="+this.getRefParam(e.i)+"()),t):{done:!0,value:b[i]}}if(c>d)return{done:!0,value:void 0};if(v=b[i=c++],i!==d)return{done:!1,value:v};if(e)throw v;return{done:!0,value:v}")+"})")));return s?s+i+")":i}serializeAsyncIteratorFactoryInstance(t){return this.getConstructor(t.a[0])+"("+this.serialize(t.a[1])+")"}serializeStreamConstructor(t){let e=this.assignIndexedValue(t.i,this.getConstructor(t.f)+"()"),r=t.a.length;if(r){let s=this.serialize(t.a[0]);for(let i=1;i<r;i++)s+=","+this.serialize(t.a[i]);return"("+e+","+s+","+this.getRefParam(t.i)+")"}return e}serializeStreamNext(t){return this.getRefParam(t.i)+".next("+this.serialize(t.f)+")"}serializeStreamThrow(t){return this.getRefParam(t.i)+".throw("+this.serialize(t.f)+")"}serializeStreamReturn(t){return this.getRefParam(t.i)+".return("+this.serialize(t.f)+")"}serialize(t){try{switch(t.t){case 2:return or[t.s];case 0:return""+t.s;case 1:return'"'+t.s+'"';case 3:return t.s+"n";case 4:return this.getRefParam(t.i);case 18:return this.serializeReference(t);case 9:return this.serializeArray(t);case 10:return this.serializeObject(t);case 11:return this.serializeNullConstructor(t);case 5:return this.serializeDate(t);case 6:return this.serializeRegExp(t);case 7:return this.serializeSet(t);case 8:return this.serializeMap(t);case 19:return this.serializeArrayBuffer(t);case 16:case 15:return this.serializeTypedArray(t);case 20:return this.serializeDataView(t);case 14:return this.serializeAggregateError(t);case 13:return this.serializeError(t);case 12:return this.serializePromise(t);case 17:return this.serializeWellKnownSymbol(t);case 21:return this.serializeBoxed(t);case 22:return this.serializePromiseConstructor(t);case 23:return this.serializePromiseResolve(t);case 24:return this.serializePromiseReject(t);case 25:return this.serializePlugin(t);case 26:return this.serializeSpecialReference(t);case 27:return this.serializeIteratorFactory(t);case 28:return this.serializeIteratorFactoryInstance(t);case 29:return this.serializeAsyncIteratorFactory(t);case 30:return this.serializeAsyncIteratorFactoryInstance(t);case 31:return this.serializeStreamConstructor(t);case 32:return this.serializeStreamNext(t);case 33:return this.serializeStreamThrow(t);case 34:return this.serializeStreamReturn(t);default:throw new ot(t)}}catch(e){throw new Ur(e)}}},ls=class extends Kr{parseItems(e){let r=[];for(let s=0,i=e.length;s<i;s++)s in e&&(r[s]=this.parse(e[s]));return r}parseArray(e,r){return Ar(e,r,this.parseItems(r))}parseProperties(e){let r=Object.entries(e),s=[],i=[];for(let a=0,o=r.length;a<o;a++)s.push(w(r[a][0])),i.push(this.parse(r[a][1]));let n=Symbol.iterator;return n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(st(this.parseIteratorFactory(),this.parse(at(e))))),n=Symbol.asyncIterator,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(it(this.parseAsyncIteratorFactory(),this.parse(W())))),n=Symbol.toStringTag,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(pe(e[n]))),n=Symbol.isConcatSpreadable,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(e[n]?he:fe)),{k:s,v:i,s:s.length}}parsePlainObject(e,r,s){return this.createObjectNode(e,r,s,this.parseProperties(r))}parseBoxed(e,r){return xr(e,this.parse(r.valueOf()))}parseTypedArray(e,r){return Er(e,r,this.parse(r.buffer))}parseBigIntTypedArray(e,r){return Pr(e,r,this.parse(r.buffer))}parseDataView(e,r){return Ir(e,r,this.parse(r.buffer))}parseError(e,r){let s=Oe(r,this.features);return kr(e,r,s?this.parseProperties(s):void 0)}parseAggregateError(e,r){let s=Oe(r,this.features);return Fr(e,r,s?this.parseProperties(s):void 0)}parseMap(e,r){let s=[],i=[];for(let[n,a]of r.entries())s.push(this.parse(n)),i.push(this.parse(a));return this.createMapNode(e,s,i,r.size)}parseSet(e,r){let s=[];for(let i of r.keys())s.push(this.parse(i));return Or(e,r.size,s)}parsePlugin(e,r){let s=this.plugins;if(s)for(let i=0,n=s.length;i<n;i++){let a=s[i];if(a.parse.sync&&a.test(r))return rt(e,a.tag,a.parse.sync(r,this,{id:e}))}}parseStream(e,r){return nt(e,this.parseSpecialReference(4),[])}parsePromise(e,r){return this.createPromiseConstructorNode(e)}parseObject(e,r){if(Array.isArray(r))return this.parseArray(e,r);if(Hr(r))return this.parseStream(e,r);let s=this.parsePlugin(e,r);if(s)return s;let i=r.constructor;switch(i){case Object:return this.parsePlainObject(e,r,!1);case void 0:return this.parsePlainObject(e,r,!0);case Date:return wr(e,r);case RegExp:return zr(e,r);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return this.parseError(e,r);case Number:case Boolean:case String:case BigInt:return this.parseBoxed(e,r);case ArrayBuffer:return Sr(e,r);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return this.parseTypedArray(e,r);case DataView:return this.parseDataView(e,r);case Map:return this.parseMap(e,r);case Set:return this.parseSet(e,r)}if(i===Promise||r instanceof Promise)return this.parsePromise(e,r);let n=this.features;if(n&16)switch(i){case BigInt64Array:case BigUint64Array:return this.parseBigIntTypedArray(e,r)}if(n&1&&typeof AggregateError<"u"&&(i===AggregateError||r instanceof AggregateError))return this.parseAggregateError(e,r);if(r instanceof Error)return this.parseError(e,r);if(Symbol.iterator in r||Symbol.asyncIterator in r)return this.parsePlainObject(e,r,!!i);throw new J(r)}parse(e){try{switch(typeof e){case"boolean":return e?he:fe;case"undefined":return ur;case"string":return pe(e);case"number":return mr(e);case"bigint":return yr(e);case"object":{if(e){let r=this.getReference(e);return r.type===0?this.parseObject(r.value,e):r.value}return dr}case"symbol":return this.parseWellKnownSymbol(e);case"function":return this.parseFunction(e);default:throw new J(e)}}catch(r){throw new Lr(r)}}};function cs(t,e={}){let r=Qe(e.plugins);return new Qr({plugins:r,markedRefs:t.m}).deserialize(t.t)}var us=class extends os{constructor(e){super(e),this.mode="cross",this.scopeId=e.scopeId}getRefParam(e){return X+"["+e+"]"}assignIndexedValue(e,r){return this.getRefParam(e)+"="+r}serializeTop(e){let r=this.serialize(e),s=e.i;if(s==null)return r;let i=this.resolvePatches(),n=this.getRefParam(s),a=this.scopeId==null?"":X,o=i?r+","+i+n:r;if(a==="")return i?"("+o+")":o;let l=this.scopeId==null?"()":"("+X+'["'+w(this.scopeId)+'"])';return"("+this.createFunction([a],o)+")"+l}},ds=class extends ls{constructor(e){super(e),this.alive=!0,this.pending=0,this.initial=!0,this.buffer=[],this.onParseCallback=e.onParse,this.onErrorCallback=e.onError,this.onDoneCallback=e.onDone}onParseInternal(e,r){try{this.onParseCallback(e,r)}catch(s){this.onError(s)}}flush(){for(let e=0,r=this.buffer.length;e<r;e++)this.onParseInternal(this.buffer[e],!1)}onParse(e){this.initial?this.buffer.push(e):this.onParseInternal(e,!1)}onError(e){if(this.onErrorCallback)this.onErrorCallback(e);else throw e}onDone(){this.onDoneCallback&&this.onDoneCallback()}pushPendingState(){this.pending++}popPendingState(){--this.pending<=0&&this.onDone()}parseProperties(e){let r=Object.entries(e),s=[],i=[];for(let a=0,o=r.length;a<o;a++)s.push(w(r[a][0])),i.push(this.parse(r[a][1]));let n=Symbol.iterator;return n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(st(this.parseIteratorFactory(),this.parse(at(e))))),n=Symbol.asyncIterator,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(it(this.parseAsyncIteratorFactory(),this.parse(Xr(e))))),n=Symbol.toStringTag,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(pe(e[n]))),n=Symbol.isConcatSpreadable,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(e[n]?he:fe)),{k:s,v:i,s:s.length}}parsePromise(e,r){return r.then(s=>{let i=this.parseWithError(s);i&&this.onParse({t:23,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(2),i],f:void 0,b:void 0,o:void 0}),this.popPendingState()},s=>{if(this.alive){let i=this.parseWithError(s);i&&this.onParse({t:24,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(3),i],f:void 0,b:void 0,o:void 0})}this.popPendingState()}),this.pushPendingState(),this.createPromiseConstructorNode(e)}parsePlugin(e,r){let s=this.plugins;if(s)for(let i=0,n=s.length;i<n;i++){let a=s[i];if(a.parse.stream&&a.test(r))return rt(e,a.tag,a.parse.stream(r,this,{id:e}))}}parseStream(e,r){let s=nt(e,this.parseSpecialReference(4),[]);return this.pushPendingState(),r.on({next:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse($r(e,n))}},throw:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(Cr(e,n))}this.popPendingState()},return:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(jr(e,n))}this.popPendingState()}}),s}parseWithError(e){try{return this.parse(e)}catch(r){this.onError(r);return}}start(e){let r=this.parseWithError(e);r&&(this.onParseInternal(r,!0),this.initial=!1,this.flush(),this.pending<=0&&this.destroy())}destroy(){this.alive&&(this.onDone(),this.alive=!1)}isAlive(){return this.alive}},hs=class extends ds{constructor(){super(...arguments),this.mode="cross"}};function fs(t,e){let r=Qe(e.plugins),s=new hs({plugins:r,refs:e.refs,disabledFeatures:e.disabledFeatures,onParse(i,n){let a=new us({plugins:r,features:s.features,scopeId:e.scopeId,markedRefs:s.marked}),o;try{o=a.serializeTop(i)}catch(l){e.onError&&e.onError(l);return}e.onSerialize(o,n)},onError:e.onError,onDone:e.onDone});return s.start(t),()=>{s.destroy()}}function ie(t){return{detail:t.detail,bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var ps={tag:"seroval-plugins/web/CustomEvent",test(t){return typeof CustomEvent>"u"?!1:t instanceof CustomEvent},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(ie(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(ie(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(ie(t))}}},serialize(t,e){return"new CustomEvent("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new CustomEvent(e.deserialize(t.type),e.deserialize(t.options))}},ct=ps,vs={tag:"seroval-plugins/web/DOMException",test(t){return typeof DOMException>"u"?!1:t instanceof DOMException},parse:{sync(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}},async async(t,e){return{name:await e.parse(t.name),message:await e.parse(t.message)}},stream(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}}},serialize(t,e){return"new DOMException("+e.serialize(t.message)+","+e.serialize(t.name)+")"},deserialize(t,e){return new DOMException(e.deserialize(t.message),e.deserialize(t.name))}},ut=vs;function ne(t){return{bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var gs={tag:"seroval-plugins/web/Event",test(t){return typeof Event>"u"?!1:t instanceof Event},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(ne(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(ne(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(ne(t))}}},serialize(t,e){return"new Event("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Event(e.deserialize(t.type),e.deserialize(t.options))}},dt=gs,ms={tag:"seroval-plugins/web/File",test(t){return typeof File>"u"?!1:t instanceof File},parse:{async async(t,e){return{name:await e.parse(t.name),options:await e.parse({type:t.type,lastModified:t.lastModified}),buffer:await e.parse(await t.arrayBuffer())}}},serialize(t,e){return"new File(["+e.serialize(t.buffer)+"],"+e.serialize(t.name)+","+e.serialize(t.options)+")"},deserialize(t,e){return new File([e.deserialize(t.buffer)],e.deserialize(t.name),e.deserialize(t.options))}},ys=ms;function ae(t){let e=[];return t.forEach((r,s)=>{e.push([s,r])}),e}var L={},bs={tag:"seroval-plugins/web/FormDataFactory",test(t){return t===L},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return L}},ws={tag:"seroval-plugins/web/FormData",extends:[ys,bs],test(t){return typeof FormData>"u"?!1:t instanceof FormData},parse:{sync(t,e){return{factory:e.parse(L),entries:e.parse(ae(t))}},async async(t,e){return{factory:await e.parse(L),entries:await e.parse(ae(t))}},stream(t,e){return{factory:e.parse(L),entries:e.parse(ae(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.entries)+")"},deserialize(t,e){let r=new FormData,s=e.deserialize(t.entries);for(let i=0,n=s.length;i<n;i++){let a=s[i];r.append(a[0],a[1])}return r}},ht=ws;function oe(t){let e=[];return t.forEach((r,s)=>{e.push([s,r])}),e}var zs={tag:"seroval-plugins/web/Headers",test(t){return typeof Headers>"u"?!1:t instanceof Headers},parse:{sync(t,e){return e.parse(oe(t))},async async(t,e){return await e.parse(oe(t))},stream(t,e){return e.parse(oe(t))}},serialize(t,e){return"new Headers("+e.serialize(t)+")"},deserialize(t,e){return new Headers(e.deserialize(t))}},Z=zs,U={},Ss={tag:"seroval-plugins/web/ReadableStreamFactory",test(t){return t===U},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createFunction(["d"],"new ReadableStream({start:"+e.createEffectfulFunction(["c"],"d.on({next:"+e.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+e.createEffectfulFunction(["v"],"c.error(v)")+",return:"+e.createEffectfulFunction([],"c.close()")+"})")+"})")},deserialize(){return U}};function Ve(t){let e=W(),r=t.getReader();async function s(){try{let i=await r.read();i.done?e.return(i.value):(e.next(i.value),await s())}catch(i){e.throw(i)}}return s().catch(()=>{}),e}var Rs={tag:"seroval/plugins/web/ReadableStream",extends:[Ss],test(t){return typeof ReadableStream>"u"?!1:t instanceof ReadableStream},parse:{sync(t,e){return{factory:e.parse(U),stream:e.parse(W())}},async async(t,e){return{factory:await e.parse(U),stream:await e.parse(Ve(t))}},stream(t,e){return{factory:e.parse(U),stream:e.parse(Ve(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.stream)+")"},deserialize(t,e){let r=e.deserialize(t.stream);return new ReadableStream({start(s){r.on({next(i){s.enqueue(i)},throw(i){s.error(i)},return(){s.close()}})}})}},Q=Rs;function De(t,e){return{body:e,cache:t.cache,credentials:t.credentials,headers:t.headers,integrity:t.integrity,keepalive:t.keepalive,method:t.method,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy}}var As={tag:"seroval-plugins/web/Request",extends:[Q,Z],test(t){return typeof Request>"u"?!1:t instanceof Request},parse:{async async(t,e){return{url:await e.parse(t.url),options:await e.parse(De(t,t.body?await t.clone().arrayBuffer():null))}},stream(t,e){return{url:e.parse(t.url),options:e.parse(De(t,t.clone().body))}}},serialize(t,e){return"new Request("+e.serialize(t.url)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Request(e.deserialize(t.url),e.deserialize(t.options))}},ft=As;function Me(t){return{headers:t.headers,status:t.status,statusText:t.statusText}}var xs={tag:"seroval-plugins/web/Response",extends:[Q,Z],test(t){return typeof Response>"u"?!1:t instanceof Response},parse:{async async(t,e){return{body:await e.parse(t.body?await t.clone().arrayBuffer():null),options:await e.parse(Me(t))}},stream(t,e){return{body:e.parse(t.clone().body),options:e.parse(Me(t))}}},serialize(t,e){return"new Response("+e.serialize(t.body)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Response(e.deserialize(t.body),e.deserialize(t.options))}},pt=xs,Es={tag:"seroval-plugins/web/URLSearchParams",test(t){return typeof URLSearchParams>"u"?!1:t instanceof URLSearchParams},parse:{sync(t,e){return e.parse(t.toString())},async async(t,e){return await e.parse(t.toString())},stream(t,e){return e.parse(t.toString())}},serialize(t,e){return"new URLSearchParams("+e.serialize(t)+")"},deserialize(t,e){return new URLSearchParams(e.deserialize(t))}},vt=Es,Ps={tag:"seroval-plugins/web/URL",test(t){return typeof URL>"u"?!1:t instanceof URL},parse:{sync(t,e){return e.parse(t.href)},async async(t,e){return await e.parse(t.href)},stream(t,e){return e.parse(t.href)}},serialize(t,e){return"new URL("+e.serialize(t)+")"},deserialize(t,e){return new URL(e.deserialize(t))}},gt=Ps;const le="Invariant Violation",{setPrototypeOf:Is=function(t,e){return t.__proto__=e,t}}=Object;class Se extends Error{framesToPop=1;name=le;constructor(e=le){super(typeof e=="number"?`${le}: ${e} (see https://github.com/apollographql/invariant-packages)`:e),Is(this,Se.prototype)}}function ks(t,e){if(!t)throw new Se(e)}function Fs(t){t.forEach(e=>{if(!e.attrs.href)return;let r=document.head.querySelector(`link[href="${e.attrs.href}"]`);r||(r=document.createElement("link"),r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",e.attrs.href),document.head.appendChild(r))})}var Os=" ";const $s={style:t=>re("style",t.attrs,()=>Lt(t.children),!0),link:t=>re("link",t.attrs,void 0,!0),script:t=>t.attrs.src?re("script",Ut(()=>t.attrs,{get id(){return t.key}}),()=>_t(Os),!0):null};function Cs(t){let{tag:e,attrs:{key:r,...s}={key:void 0},children:i}=t;return $s[e]({attrs:s,key:r,children:i})}function js(t,e,r,s="default"){return Tt(async()=>{{const n=(await t.import())[s],o=(await e.inputs?.[t.src].assets()).filter(c=>c.tag==="style"||c.attrs.rel==="stylesheet");return typeof window<"u"&&Fs(o),{default:c=>[...o.map(d=>Cs(d)),We(n,c)]}}})}const j={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function Ts(t={}){const e={options:t,rootNode:mt(),staticRoutesMap:{}},r=s=>t.strictTrailingSlash?s:s.replace(/\/$/,"")||"/";if(t.routes)for(const s in t.routes)Ne(e,r(s),t.routes[s]);return{ctx:e,lookup:s=>Vs(e,r(s)),insert:(s,i)=>Ne(e,r(s),i),remove:s=>Ds(e,r(s))}}function Vs(t,e){const r=t.staticRoutesMap[e];if(r)return r.data;const s=e.split("/"),i={};let n=!1,a=null,o=t.rootNode,l=null;for(let c=0;c<s.length;c++){const d=s[c];o.wildcardChildNode!==null&&(a=o.wildcardChildNode,l=s.slice(c).join("/"));const u=o.children.get(d);if(u!==void 0)o=u;else if(o=o.placeholderChildNode,o!==null)i[o.paramName]=d,n=!0;else break}return(o===null||o.data===null)&&a!==null&&(o=a,i[o.paramName||"_"]=l,n=!0),o?n?{...o.data,params:n?i:void 0}:o.data:null}function Ne(t,e,r){let s=!0;const i=e.split("/");let n=t.rootNode,a=0;for(const o of i){let l;if(l=n.children.get(o))n=l;else{const c=Ms(o);l=mt({type:c,parent:n}),n.children.set(o,l),c===j.PLACEHOLDER?(l.paramName=o==="*"?`_${a++}`:o.slice(1),n.placeholderChildNode=l,s=!1):c===j.WILDCARD&&(n.wildcardChildNode=l,l.paramName=o.slice(3)||"_",s=!1),n=l}}return n.data=r,s===!0&&(t.staticRoutesMap[e]=n),n}function Ds(t,e){let r=!1;const s=e.split("/");let i=t.rootNode;for(const n of s)if(i=i.children.get(n),!i)return r;if(i.data){const n=s[s.length-1];if(i.data=null,Object.keys(i.children).length===0){const a=i.parent;a.children.delete(n),a.wildcardChildNode=null,a.placeholderChildNode=null}r=!0}return r}function mt(t={}){return{type:t.type||j.NORMAL,parent:t.parent||null,children:new Map,data:t.data||null,paramName:t.paramName||null,wildcardChildNode:null,placeholderChildNode:null}}function Ms(t){return t.startsWith("**")?j.WILDCARD:t[0]===":"||t==="*"?j.PLACEHOLDER:j.NORMAL}function Ns(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function s(i,n){if(r)return!(r=!1);const a={to:i,options:n,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const o of t)o.listener({...a,from:o.location,retry:l=>{l&&(r=!0),o.navigate(i,{...n,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:s}}let ge;function yt(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),ge=window.history.state._depth}b||yt();function Mi(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Ni(t,e){let r=!1;return()=>{const s=ge;yt();const i=s==null?null:ge-s;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const Ls=/^(?:[a-z0-9]+:)?\/\//i,Us=/^\/+|(\/)\/+$/g,bt="http://sr";function _(t,e=!1){const r=t.replace(Us,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function G(t,e,r){if(Ls.test(e))return;const s=_(t),i=r&&_(r);let n="";return!i||e.startsWith("/")?n=s:i.toLowerCase().indexOf(s.toLowerCase())!==0?n=s+i:n=i,(n||"/")+_(e,!n)}function _s(t,e){if(t==null)throw new Error(e);return t}function Bs(t,e){return _(t).replace(/\/*(\*.*)?$/g,"")+_(e)}function wt(t){const e={};return t.searchParams.forEach((r,s)=>{e[s]=r}),e}function Ws(t,e,r){const[s,i]=t.split("/*",2),n=s.split("/").filter(Boolean),a=n.length;return o=>{const l=o.split("/").filter(Boolean),c=l.length-a;if(c<0||c>0&&i===void 0&&!e)return null;const d={path:a?"":"/",params:{}},u=h=>r===void 0?void 0:r[h];for(let h=0;h<a;h++){const v=n[h],f=l[h],g=v[0]===":",y=g?v.slice(1):v;if(g&&ce(f,u(y)))d.params[y]=f;else if(g||!ce(f,v))return null;d.path+=`/${f}`}if(i){const h=c?l.slice(-c).join("/"):"";if(ce(h,u(i)))d.params[i]=h;else return null}return d}}function ce(t,e){const r=s=>s.localeCompare(t,void 0,{sensitivity:"base"})===0;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function qs(t){const[e,r]=t.pattern.split("/*",2),s=e.split("/").filter(Boolean);return s.reduce((i,n)=>i+(n.startsWith(":")?2:3),s.length-(r===void 0?0:1))}function Ks(t){const e=new Map,r=ye();return new Proxy({},{get(s,i){return e.has(i)||qe(r,()=>e.set(i,k(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function zt(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),s=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(s);)i.push(r+=e[1]),s=s.slice(e[0].length);return zt(s).reduce((n,a)=>[...n,...i.map(o=>o+a)],[])}const Hs=100,Xs=Ke(),Gs=Ke(),St=()=>_s(He(Xs),"<A> and 'use' router primitives can be only used inside a Route."),Js=()=>St().navigatorFactory();function Zs(t,e=""){const{component:r,load:s,children:i,info:n}=t,a=!i||Array.isArray(i)&&!i.length,o={key:t,component:r,load:s,info:n};return Rt(t.path).reduce((l,c)=>{for(const d of zt(c)){const u=Bs(e,d);let h=a?u:u.split("/*",1)[0];h=h.split("/").map(v=>v.startsWith(":")||v.startsWith("*")?v:encodeURIComponent(v)).join("/"),l.push({...o,originalPath:d,pattern:h,matcher:Ws(h,!a,t.matchFilters)})}return l},[])}function Qs(t,e=0){return{routes:t,score:qs(t[t.length-1])*1e4-e,matcher(r){const s=[];for(let i=t.length-1;i>=0;i--){const n=t[i],a=n.matcher(r);if(!a)return null;s.unshift({...a,route:n})}return s}}}function Rt(t){return Array.isArray(t)?t:[t]}function Ys(t,e="",r=[],s=[]){const i=Rt(t);for(let n=0,a=i.length;n<a;n++){const o=i[n];if(o&&typeof o=="object"){o.hasOwnProperty("path")||(o.path="");const l=Zs(o,e);for(const c of l){r.push(c);const d=Array.isArray(o.children)&&o.children.length===0;if(o.children&&!d)Ys(o.children,c.pattern,r,s);else{const u=Qs([...r],s.length);s.push(u)}r.pop()}}}return r.length?s:s.sort((n,a)=>a.score-n.score)}function ei(t,e){for(let r=0,s=t.length;r<s;r++){const i=t[r].matcher(e);if(i)return i}return[]}function ti(t,e){const r=new URL(bt),s=k(l=>{const c=t();try{return new URL(c,r)}catch{return console.error(`Invalid path ${c}`),l}},r,{equals:(l,c)=>l.href===c.href}),i=k(()=>s().pathname),n=k(()=>s().search,!0),a=k(()=>s().hash),o=()=>"";return{get pathname(){return i()},get search(){return n()},get hash(){return a()},get state(){return e()},get key(){return o()},query:Ks(Dt(n,()=>wt(s())))}}let R;function ri(){return R}function Li(t,e,r,s={}){const{signal:[i,n],utils:a={}}=t,o=a.parsePath||(p=>p),l=a.renderPath||(p=>p),c=a.beforeLeave||Ns(),d=G("",s.base||"");if(d===void 0)throw new Error(`${d} is not a valid base path`);d&&!i().value&&n({value:d,replace:!0,scroll:!1});const[u,h]=F(!1),v=async p=>{h(!0);try{await N(p)}finally{h(!1)}},[f,g]=F(i().value),[y,Ae]=F(i().state),kt=ti(f,y),T=[],ee=F(b?jt():[]),xe={pattern:d,params:{},path:()=>d,outlet:()=>null,resolvePath(p){return G(d,p)}};return Vt(()=>{const{value:p,state:m}=i();Pe(()=>{p!==f()&&v(()=>{R="native",g(p),Ae(m),Ie(),ee[1]([])}).then(()=>{R=void 0})})}),{base:xe,location:kt,isRouting:u,renderPath:l,parsePath:o,navigatorFactory:Ot,beforeLeave:c,preloadRoute:Ct,singleFlight:s.singleFlight===void 0?!0:s.singleFlight,submissions:ee};function Ft(p,m,E){Pe(()=>{if(typeof m=="number"){m&&(a.go?a.go(m):console.warn("Router integration does not support relative routing"));return}const{replace:q,resolve:te,scroll:P,state:$}={replace:!1,resolve:!0,scroll:!0,...E},z=te?p.resolvePath(m):G("",m);if(z===void 0)throw new Error(`Path '${m}' is not a routable path`);if(T.length>=Hs)throw new Error("Too many redirects");const Ee=f();if(z!==Ee||$!==y()){if(b){const K=O();K&&(K.response={status:302,headers:new Headers({Location:z})}),n({value:z,replace:q,scroll:P,state:$})}else if(c.confirm(z,E)){const K=T.push({value:Ee,replace:q,scroll:P,state:y()});v(()=>{R="navigate",g(z),Ae($),Ie(),ee[1]([])}).then(()=>{T.length===K&&(R=void 0,$t({value:z,state:$}))})}}})}function Ot(p){return p=p||He(Gs)||xe,(m,E)=>Ft(p,m,E)}function $t(p){const m=T[0];m&&((p.value!==m.value||p.state!==m.state)&&n({...p,replace:m.replace,scroll:m.scroll}),T.length=0)}function Ct(p,m){const E=ei(r(),p.pathname),q=R;R="preload";for(let te in E){const{route:P,params:$}=E[te];P.component&&P.component.preload&&P.component.preload();const{load:z}=P;m&&z&&qe(e(),()=>z({params:$,location:{pathname:p.pathname,search:p.search,hash:p.hash,query:wt(p),state:null,key:""},intent:"preload"}))}R=q}function jt(){const p=O();return p&&p.router&&p.router.submission?[p.router.submission]:[]}}function Ui(t,e,r,s,i){const{base:n,location:a}=t,{pattern:o,component:l,load:c}=s().route,d=k(()=>s().path);l&&l.preload&&l.preload();const u=c?c({params:i,location:a,intent:R||"initial"}):void 0;return{parent:e,pattern:o,path:d,params:i,outlet:()=>l?We(l,{params:i,location:a,data:u,get children(){return r()}}):r(),resolvePath(v){return G(n.path(),v,d())}}}const si="Location",ii=5e3,ni=18e4;let B=new Map;b||setInterval(()=>{const t=Date.now();for(let[e,r]of B.entries())!r[3].count&&t-r[0]>ni&&B.delete(e)},3e5);function Re(){if(!b)return B;const t=O();if(!t)throw new Error("Cannot find cache context");return(t.router||(t.router={})).cache||(t.router.cache=new Map)}function ai(t,e=!0){return N(()=>{const r=Date.now();At(t,s=>{e&&(s[0]=0),s[3][1](r)})})}function At(t,e){t&&!Array.isArray(t)&&(t=[t]);for(let r of B.keys())(t===void 0||oi(r,t))&&e(B.get(r))}function Y(t,e){t.GET&&(t=t.GET);const r=(...s)=>{const i=Re(),n=ri(),o=ye()?Js():void 0,l=Date.now(),c=e+me(s);let d=i.get(c),u;if(b){const f=O();if(f){const g=(f.router||(f.router={})).dataOnly;if(g){const y=f&&(f.router.data||(f.router.data={}));if(y&&c in y)return y[c];if(Array.isArray(g)&&!g.includes(c))return y[c]=void 0,Promise.resolve()}}}if(Mt()&&!b&&(u=!0,Xe(()=>d[3].count--)),d&&d[0]&&(b||n==="native"||d[3].count||Date.now()-d[0]<ii)){u&&(d[3].count++,d[3][0]()),d[2]==="preload"&&n!=="preload"&&(d[0]=l);let f=d[1];return n!=="preload"&&(f="then"in d[1]?d[1].then(v(!1),v(!0)):v(!1)(d[1]),!b&&n==="navigate"&&N(()=>d[3][1](d[0]))),f}let h=!b&&S.context&&S.has(c)?S.load(c):t(...s);if(d?(d[0]=l,d[1]=h,d[2]=n,!b&&n==="navigate"&&N(()=>d[3][1](d[0]))):(i.set(c,d=[l,h,n,F(l)]),d[3].count=0),u&&(d[3].count++,d[3][0]()),b){const f=O();if(f&&f.router.dataOnly)return f.router.data[c]=h}if(n!=="preload"&&(h="then"in h?h.then(v(!1),v(!0)):v(!1)(h)),b&&S.context&&S.context.async&&!S.context.noHydrate){const f=O();(!f||!f.serverOnly)&&S.context.serialize(c,h)}return h;function v(f){return async g=>{if(g instanceof Response){if(g.headers.has("Location")){o&&N(()=>{let y=g.headers.get(si);y&&y.startsWith("/")?o(y,{replace:!0}):!b&&y&&(window.location.href=y)});return}g.customBody&&(g=await g.customBody())}if(f)throw g;return g}}};return r.keyFor=(...s)=>e+me(s),r.key=e,r}Y.set=(t,e)=>{const r=Re(),s=Date.now();let i=r.get(t);i?(i[0]=s,i[1]=e,i[2]="preload"):(r.set(t,i=[s,e,,F(s)]),i[3].count=0)};Y.clear=()=>Re().clear();function oi(t,e){for(let r of e)if(t.startsWith(r))return!0;return!1}function me(t){return JSON.stringify(t,(e,r)=>li(r)?Object.keys(r).sort().reduce((s,i)=>(s[i]=r[i],s),{}):r)}function li(t){let e;return t!=null&&typeof t=="object"&&(!(e=Object.getPrototypeOf(t))||e===Object.prototype)}const Le=new Map;function ci(t,e){const r=St(),s=k(()=>r.submissions[0]().filter(i=>i.url===t.toString()&&(!e||e(i.input))));return new Proxy([],{get(i,n){return n===Nt?s():n==="pending"?s().some(a=>!a.result):s()[n]}})}function _i(t,e){const r=ci(t,e);return new Proxy({},{get(s,i){return r[r.length-1]?.[i]}})}function xt(t,e){function r(...i){const n=this.r,a=this.f,o=(n.singleFlight&&t.withOptions?t.withOptions({headers:{"X-Single-Flight":"true"}}):t)(...i),[l,c]=F();let d;function u(h){return async v=>{const f=await di(v,h,n.navigatorFactory());if(!f)return d.clear();if(c(f),f.error&&!a)throw f.error;return f.data}}return n.submissions[1](h=>[...h,d={input:i,url:s,get result(){return l()?.data},get error(){return l()?.error},get pending(){return!l()},clear(){n.submissions[1](v=>v.filter(f=>f.input!==i))},retry(){return c(void 0),t(...i).then(u(),u(!0))}}]),o.then(u(),u(!0))}const s=t.url||e&&`https://action/${e}`||(b?"":`https://action/${ui(t.toString())}`);return Et(r,s)}function Et(t,e){return t.toString=()=>{if(!e)throw new Error("Client Actions need explicit names if server rendered");return e},t.with=function(...r){const s=function(...n){return t.call(this,...r,...n)},i=new URL(e,bt);return i.searchParams.set("args",me(r)),Et(s,(i.origin==="https://action"?i.origin:"")+i.pathname+i.search)},t.url=e,b||(Le.set(e,t),ye()&&Xe(()=>Le.delete(e))),t}const ui=t=>t.split("").reduce((e,r)=>(e<<5)-e+r.charCodeAt(0)|0,0);async function di(t,e,r){let s,i,n;if(t instanceof Response){if(t.headers.has("X-Revalidate")&&(i=n=t.headers.get("X-Revalidate").split(",")),t.customBody&&(s=await t.customBody(),t.headers.has("X-Single-Flight")&&(i||(i=[]),n||(n=[]),Object.keys(s).forEach(a=>{a!=="_$value"&&(i.push(a),Y.set(a,s[a]))}),s=s._$value)),t.headers.has("Location")){const a=t.headers.get("Location")||"/";a.startsWith("http")?window.location.href=a:r(a)}}else{if(e)return{error:t};s=t}return At(n,a=>a[0]=0),await ai(i,!1),s!=null?{data:s}:void 0}const Bi=xt(Wt),Wi=xt(qt),hi=Y(Kt,"userProfile"),fi={load:()=>hi()},Pt=[{$component:{src:"src/routes/(auth).tsx?pick=default&pick=$css",build:()=>import("./(auth).mjs"),import:()=>import("./(auth).mjs")},$$route:{require:()=>({route:fi}),src:"src/routes/(auth).tsx?pick=route"},path:"/(auth)",filePath:"/home/sh1man999/solidstart-auth/src/routes/(auth).tsx"},{$component:{src:"src/routes/login.tsx?pick=default&pick=$css",build:()=>import("./login.mjs"),import:()=>import("./login.mjs")},path:"/login",filePath:"/home/sh1man999/solidstart-auth/src/routes/login.tsx"},{$component:{src:"src/routes/(auth)/(main).tsx?pick=default&pick=$css",build:()=>import("./(main).mjs"),import:()=>import("./(main).mjs")},path:"/(auth)/(main)",filePath:"/home/sh1man999/solidstart-auth/src/routes/(auth)/(main).tsx"}],pi=vi(Pt.filter(t=>t.$component));function vi(t){function e(r,s,i,n){const a=Object.values(r).find(o=>i.startsWith(o.id+"/"));return a?(e(a.children||(a.children=[]),s,i.slice(a.id.length)),r):(r.push({...s,id:i,path:i.replace(/\/\([^)/]+\)/g,"").replace(/\./g,"/")}),r)}return t.sort((r,s)=>r.path.length-s.path.length).reduce((r,s)=>e(r,s,s.path,s.path),[])}function gi(t){return t.$GET||t.$POST||t.$PUT||t.$PATCH||t.$DELETE}Ts({routes:Pt.reduce((t,e)=>{if(!gi(e))return t;let r=e.path.replace(/\(.*\)\/?/g,"").replace(/\*([^/]*)/g,(s,i)=>`**:${i}`);if(/:[^/]*\?/g.test(r))throw new Error(`Optional parameters are not supported in API routes: ${r}`);if(t[r])throw new Error(`Duplicate API routes for "${r}" found at "${t[r].route.path}" and "${e.path}"`);return t[r]={route:e},t},{})});function It(){function t(r){return{...r,...r.$$route?r.$$route.require().route:void 0,info:{...r.$$route?r.$$route.require().route.info:{},filesystem:!0},component:js(r.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:r.children?r.children.map(t):void 0}}return pi.map(t)}let Ue;const qi=b?()=>O().routes:()=>Ue||(Ue=It());function mi(t){const e=Ht(t.nativeEvent,"flash");if(!e)return;let r=JSON.parse(e);if(!r||!r.result)return;const s=[...r.input.slice(0,-1),new Map(r.input[r.input.length-1])];return Xt(t.nativeEvent,"flash","",{maxAge:0}),{input:s,url:r.url,pending:!1,result:r.error?new Error(r.result):r.result}}async function yi(t){const e=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,t.response.headers.set("Content-Type","text/html"),Object.assign(t,{manifest:await e.json(),assets:[...await e.inputs[e.handler].assets()],router:{submission:mi(t)},routes:It(),$islands:new Set})}function bi(t){const r=t.length.toString(16),s="00000000".substring(0,8-r.length)+r;return new TextEncoder().encode(`;0x${s};${t}`)}function _e(t,e){return new ReadableStream({start(r){fs(e,{scopeId:t,plugins:[ct,ut,dt,ht,Z,Q,ft,pt,vt,gt],onSerialize(s,i){r.enqueue(bi(i?`(${tr(t)},${s})`:s))},onDone(){r.close()},onError(s){r.error(s)}})}})}async function wi(t){const e=Gt(t),r=e.request,s=r.headers.get("X-Server-Id"),i=r.headers.get("X-Server-Instance"),n=r.headers.has("X-Single-Flight"),a=new URL(r.url);let o,l;if(s)ks(typeof s=="string","Invalid server function"),[o,l]=s.split("#");else if(o=a.searchParams.get("id"),l=a.searchParams.get("name"),!o||!l)throw new Error("Invalid request");const c=(await globalThis.MANIFEST["server-fns"].chunks[o].import())[l];let d=[];if(!i||t.method==="GET"){const u=a.searchParams.get("args");u&&JSON.parse(u).forEach(h=>d.push(h))}if(t.method==="POST"){const u=r.headers.get("content-type");if(u?.startsWith("multipart/form-data")||u?.startsWith("application/x-www-form-urlencoded"))d.push(await new Request(r,{...r,body:t.node.req.body}).formData());else if(u?.startsWith("application/json")){const h=new Request(r,{...r,body:t.node.req.body});d=cs(await h.json(),{plugins:[ct,ut,dt,ht,Z,Q,ft,pt,vt,gt]})}}try{let u=await Ge(e,async()=>(S.context={event:e},e.locals.serverFunctionMeta={id:o+"#"+l},c(...d)));if(n&&i&&(u=await Be(e,u)),u instanceof Response&&i&&(u.headers&&ke(t,u.headers),u.status&&(u.status<300||u.status>=400)&&Fe(t,u.status),u.customBody?u=await u.customBody():u.body==null&&(u=null)),!i){const h=u instanceof Error;let v=new URL(r.headers.get("referer")).toString();return u instanceof Response&&u.headers.has("Location")&&(v=new URL(u.headers.get("Location"),new URL(r.url).origin+"").toString()),new Response(null,{status:302,headers:{Location:v,...u?{"Set-Cookie":`flash=${JSON.stringify({url:a.pathname+encodeURIComponent(a.search),result:h?u.message:u,error:h,input:[...d.slice(0,-1),[...d[d.length-1].entries()]]})}; Secure; HttpOnly;`}:{}}})}return se(t,"content-type","text/javascript"),_e(i,u)}catch(u){if(u instanceof Response)n&&i&&(u=await Be(e,u)),u.headers&&ke(t,u.headers),u.status&&(!i||u.status<300||u.status>=400)&&Fe(t,u.status),u.customBody?u=u.customBody():u.body==null&&(u=null);else{const h=u instanceof Error?u.message:typeof u=="string"?u:"true";se(t,"X-Error",h)}return i?(se(t,"content-type","text/javascript"),_e(i,u)):u}}let ue;async function Be(t,e){let r,s=new URL(t.request.headers.get("referer")).toString();e instanceof Response&&(e.headers.has("X-Revalidate")&&(r=e.headers.get("X-Revalidate").split(",")),e.headers.has("Location")&&(s=new URL(e.headers.get("Location"),new URL(t.request.url).origin+"").toString()));const i=Jt(t);return i.request=new Request(s),await Ge(i,async()=>{await yi(i),ue||(ue=(await import("./app.mjs")).default),i.router.dataOnly=r||!0,i.router.previousUrl=t.request.headers.get("referer");try{Bt(()=>{S.context.event=i,ue()})}catch(o){console.log(o)}const n=i.router.data;if(!n)return e;let a=!1;for(const o in n)n[o]===void 0?delete n[o]:a=!0;return a&&(e instanceof Response?e.customBody&&(n._$value=e.customBody()):(n._$value=e,e=new Response(null,{status:200})),e.customBody=()=>n,e.headers.set("X-Single-Flight","true")),e})}const Ki=Zt(wi);export{qi as F,Xs as R,Li as a,Ks as b,Ys as c,Ui as d,Gs as e,Le as f,ei as g,Ns as h,hi as i,Bi as j,Mi as k,Wi as l,bt as m,Ni as n,Ki as o,yt as s,_i as u};
